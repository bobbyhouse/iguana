version: 2
file:
    path: internal/model/model.go
    sha256: fd73bfc26695da2871156e599bbe5550352a42f8207ba7a7890fe5631f5b1474
package:
    name: model
    imports:
        - path: context
        - path: crypto/sha256
        - path: encoding/hex
        - path: fmt
        - path: gopkg.in/yaml.v3
        - path: iguana/baml_client
          alias: b
        - path: iguana/baml_client/types
        - path: iguana/internal/evidence
        - path: iguana/internal/settings
        - path: io/fs
        - path: os
        - path: path/filepath
        - path: sort
        - path: strings
        - path: time
symbols:
    functions:
        - name: GenerateSystemModel
          exported: true
          params:
            - context.Context
            - string
          returns:
            - '*SystemModel'
            - error
        - name: ReadSystemModel
          exported: true
          params:
            - string
          returns:
            - '*SystemModel'
            - error
        - name: SystemModelUpToDate
          exported: true
          params:
            - string
            - string
          returns:
            - bool
            - error
        - name: WriteSystemModel
          exported: true
          params:
            - '*SystemModel'
            - string
          returns:
            - error
        - name: buildBoundaries
          exported: false
          params:
            - '[]*evidence.EvidenceBundle'
          returns:
            - Boundaries
        - name: buildConcurrencyDomains
          exported: false
          params:
            - '[]*evidence.EvidenceBundle'
          returns:
            - '[]ConcurrencyDomain'
        - name: buildEffects
          exported: false
          params:
            - '[]*evidence.EvidenceBundle'
          returns:
            - '[]Effect'
        - name: buildInventory
          exported: false
          params:
            - '[]*evidence.EvidenceBundle'
          returns:
            - Inventory
        - name: buildPackageSummaries
          exported: false
          params:
            - '[]*evidence.EvidenceBundle'
            - '*settings.Settings'
            - string
          returns:
            - '[]types.PackageSummary'
        - name: computeBundleSetHash
          exported: false
          params:
            - '[]*evidence.EvidenceBundle'
          returns:
            - string
        - name: evidenceRef
          exported: false
          params:
            - string
            - int
            - string
          returns:
            - string
        - name: formatFuncDesc
          exported: false
          params:
            - evidence.Function
          returns:
            - string
        - name: formatStructDesc
          exported: false
          params:
            - evidence.TypeDecl
          returns:
            - string
        - name: hasSymbol
          exported: false
          params:
            - '*evidence.EvidenceBundle'
            - string
          returns:
            - bool
        - name: linkEffectsToDomains
          exported: false
          params:
            - '[]Effect'
            - '[]StateDomain'
            - '[]*evidence.EvidenceBundle'
        - name: loadEvidenceBundles
          exported: false
          params:
            - string
          returns:
            - '[]*evidence.EvidenceBundle'
            - error
        - name: mapOpenQuestions
          exported: false
          params:
            - '[]types.OpenQuestionSpec'
          returns:
            - '[]OpenQuestion'
        - name: mapStateDomains
          exported: false
          params:
            - '[]types.StateDomainSpec'
            - '[]*evidence.EvidenceBundle'
          returns:
            - '[]StateDomain'
        - name: mapTrustZones
          exported: false
          params:
            - '[]types.TrustZoneSpec'
            - '[]*evidence.EvidenceBundle'
          returns:
            - '[]TrustZone'
        - name: pkgBundleRefs
          exported: false
          params:
            - '[]*evidence.EvidenceBundle'
            - '[]string'
          returns:
            - '[]string'
        - name: readModuleName
          exported: false
          params:
            - string
          returns:
            - string
        - name: sortedCopy
          exported: false
          params:
            - '[]string'
          returns:
            - '[]string'
    types:
        - name: Boundaries
          kind: struct
          exported: true
          fields:
            - name: Process
              type: '[]ProcessBoundary'
            - name: Persistence
              type: '[]PersistenceBoundary'
            - name: Network
              type: '*NetworkBoundary'
        - name: ConcurrencyDomain
          kind: struct
          exported: true
          fields:
            - name: ID
              type: string
            - name: Files
              type: '[]string'
            - name: EvidenceRefs
              type: '[]string'
        - name: Effect
          kind: struct
          exported: true
          fields:
            - name: Kind
              type: string
            - name: Domain
              type: string
            - name: Via
              type: string
            - name: EvidenceRefs
              type: '[]string'
        - name: Entrypoint
          kind: struct
          exported: true
          fields:
            - name: Package
              type: string
            - name: Symbol
              type: string
            - name: EvidenceRefs
              type: '[]string'
        - name: Inventory
          kind: struct
          exported: true
          fields:
            - name: Packages
              type: '[]PackageEntry'
            - name: Entrypoints
              type: '[]Entrypoint'
        - name: ModelInputs
          kind: struct
          exported: true
          fields:
            - name: BundleSetSHA256
              type: string
        - name: NetworkBoundary
          kind: struct
          exported: true
          fields:
            - name: Outbound
              type: '[]SymbolRef'
            - name: EvidenceRefs
              type: '[]string'
        - name: OpenQuestion
          kind: struct
          exported: true
          fields:
            - name: Question
              type: string
            - name: RelatedDomain
              type: string
            - name: MissingEvidence
              type: '[]string'
        - name: PackageEntry
          kind: struct
          exported: true
          fields:
            - name: Name
              type: string
            - name: Files
              type: '[]string'
            - name: Imports
              type: '[]string'
            - name: EvidenceRefs
              type: '[]string'
        - name: Persistence
          kind: struct
          exported: true
          fields:
            - name: Kind
              type: string
            - name: EvidenceRefs
              type: '[]string'
        - name: PersistenceBoundary
          kind: struct
          exported: true
          fields:
            - name: Kind
              type: string
            - name: Writers
              type: '[]SymbolRef'
            - name: EvidenceRefs
              type: '[]string'
        - name: ProcessBoundary
          kind: struct
          exported: true
          fields:
            - name: Kind
              type: string
            - name: EvidenceRefs
              type: '[]string'
        - name: StateDomain
          kind: struct
          exported: true
          fields:
            - name: ID
              type: string
            - name: Description
              type: string
            - name: Owners
              type: '[]string'
            - name: Aggregate
              type: string
            - name: Representations
              type: '[]string'
            - name: PrimaryMutators
              type: '[]string'
            - name: PrimaryReaders
              type: '[]string'
            - name: Persistence
              type: '*Persistence'
            - name: EvidenceRefs
              type: '[]string'
            - name: Confidence
              type: float64
        - name: SymbolRef
          kind: struct
          exported: true
          fields:
            - name: File
              type: string
            - name: EvidenceRefs
              type: '[]string'
        - name: SystemModel
          kind: struct
          exported: true
          fields:
            - name: Version
              type: int
            - name: GeneratedAt
              type: string
            - name: Inputs
              type: ModelInputs
            - name: Inventory
              type: Inventory
            - name: StateDomains
              type: '[]StateDomain'
            - name: Boundaries
              type: Boundaries
            - name: Effects
              type: '[]Effect'
            - name: Transitions
              type: '[]Transition'
            - name: TrustZones
              type: '[]TrustZone'
            - name: ConcurrencyDomains
              type: '[]ConcurrencyDomain'
            - name: OpenQuestions
              type: '[]OpenQuestion'
        - name: Transition
          kind: struct
          exported: true
          fields:
            - name: From
              type: string
            - name: To
              type: string
            - name: EvidenceRefs
              type: '[]string'
        - name: TrustZone
          kind: struct
          exported: true
          fields:
            - name: ID
              type: string
            - name: Packages
              type: '[]string'
            - name: ExternalVia
              type: '[]string'
            - name: EvidenceRefs
              type: '[]string'
    constructors:
        - GenerateSystemModel
        - ReadSystemModel
        - buildBoundaries
        - buildConcurrencyDomains
        - buildEffects
        - buildInventory
        - mapOpenQuestions
        - mapStateDomains
        - mapTrustZones
calls:
    - from: GenerateSystemModel
      to: Format
    - from: GenerateSystemModel
      to: UTC
    - from: GenerateSystemModel
      to: b.InferSystemModel
    - from: GenerateSystemModel
      to: buildBoundaries
    - from: GenerateSystemModel
      to: buildConcurrencyDomains
    - from: GenerateSystemModel
      to: buildEffects
    - from: GenerateSystemModel
      to: buildInventory
    - from: GenerateSystemModel
      to: buildPackageSummaries
    - from: GenerateSystemModel
      to: computeBundleSetHash
    - from: GenerateSystemModel
      to: fmt.Errorf
    - from: GenerateSystemModel
      to: len
    - from: GenerateSystemModel
      to: linkEffectsToDomains
    - from: GenerateSystemModel
      to: loadEvidenceBundles
    - from: GenerateSystemModel
      to: mapOpenQuestions
    - from: GenerateSystemModel
      to: mapStateDomains
    - from: GenerateSystemModel
      to: mapTrustZones
    - from: GenerateSystemModel
      to: readModuleName
    - from: GenerateSystemModel
      to: settings.LoadSettings
    - from: GenerateSystemModel
      to: time.Now
    - from: ReadSystemModel
      to: fmt.Errorf
    - from: ReadSystemModel
      to: os.ReadFile
    - from: ReadSystemModel
      to: yaml.Unmarshal
    - from: SystemModelUpToDate
      to: ReadSystemModel
    - from: SystemModelUpToDate
      to: computeBundleSetHash
    - from: SystemModelUpToDate
      to: fmt.Errorf
    - from: SystemModelUpToDate
      to: len
    - from: SystemModelUpToDate
      to: loadEvidenceBundles
    - from: WriteSystemModel
      to: fmt.Errorf
    - from: WriteSystemModel
      to: os.WriteFile
    - from: WriteSystemModel
      to: yaml.Marshal
    - from: buildBoundaries
      to: append
    - from: buildBoundaries
      to: evidenceRef
    - from: buildBoundaries
      to: len
    - from: buildConcurrencyDomains
      to: append
    - from: buildConcurrencyDomains
      to: evidenceRef
    - from: buildConcurrencyDomains
      to: sort.Slice
    - from: buildEffects
      to: append
    - from: buildEffects
      to: evidenceRef
    - from: buildEffects
      to: sort.Slice
    - from: buildInventory
      to: append
    - from: buildInventory
      to: evidenceRef
    - from: buildInventory
      to: hasSymbol
    - from: buildInventory
      to: len
    - from: buildInventory
      to: make
    - from: buildInventory
      to: sort.Strings
    - from: buildInventory
      to: strings.Split
    - from: buildPackageSummaries
      to: append
    - from: buildPackageSummaries
      to: formatFuncDesc
    - from: buildPackageSummaries
      to: formatStructDesc
    - from: buildPackageSummaries
      to: hasAnySignal
    - from: buildPackageSummaries
      to: len
    - from: buildPackageSummaries
      to: make
    - from: buildPackageSummaries
      to: s.IsDenied
    - from: buildPackageSummaries
      to: sort.Strings
    - from: buildPackageSummaries
      to: strings.TrimPrefix
    - from: buildPackageSummaries
      to: topN
    - from: buildPackageSummaries.<anonymous>
      to: append
    - from: buildPackageSummaries.<anonymous>
      to: len
    - from: buildPackageSummaries.<anonymous>
      to: make
    - from: buildPackageSummaries.<anonymous>
      to: sort.Strings
    - from: computeBundleSetHash
      to: hex.EncodeToString
    - from: computeBundleSetHash
      to: len
    - from: computeBundleSetHash
      to: make
    - from: computeBundleSetHash
      to: sha256.Sum256
    - from: computeBundleSetHash
      to: sort.Strings
    - from: computeBundleSetHash
      to: strings.Join
    - from: formatFuncDesc
      to: len
    - from: formatFuncDesc
      to: sb.String
    - from: formatFuncDesc
      to: sb.WriteString
    - from: formatStructDesc
      to: len
    - from: formatStructDesc
      to: sb.String
    - from: formatStructDesc
      to: sb.WriteString
    - from: linkEffectsToDomains
      to: len
    - from: linkEffectsToDomains
      to: make
    - from: loadEvidenceBundles
      to: filepath.WalkDir
    - from: loadEvidenceBundles
      to: fmt.Errorf
    - from: loadEvidenceBundles
      to: settings.LoadSettings
    - from: loadEvidenceBundles
      to: sort.Slice
    - from: loadEvidenceBundles.<anonymous>
      to: append
    - from: loadEvidenceBundles.<anonymous>
      to: d.IsDir
    - from: loadEvidenceBundles.<anonymous>
      to: d.Name
    - from: loadEvidenceBundles.<anonymous>
      to: filepath.Rel
    - from: loadEvidenceBundles.<anonymous>
      to: filepath.ToSlash
    - from: loadEvidenceBundles.<anonymous>
      to: fmt.Errorf
    - from: loadEvidenceBundles.<anonymous>
      to: os.ReadFile
    - from: loadEvidenceBundles.<anonymous>
      to: settings.IsDenied
    - from: loadEvidenceBundles.<anonymous>
      to: strings.HasPrefix
    - from: loadEvidenceBundles.<anonymous>
      to: strings.HasSuffix
    - from: loadEvidenceBundles.<anonymous>
      to: yaml.Unmarshal
    - from: mapOpenQuestions
      to: append
    - from: mapOpenQuestions
      to: sort.Slice
    - from: mapOpenQuestions
      to: sortedCopy
    - from: mapStateDomains
      to: append
    - from: mapStateDomains
      to: pkgBundleRefs
    - from: mapStateDomains
      to: sort.Slice
    - from: mapStateDomains
      to: sortedCopy
    - from: mapTrustZones
      to: append
    - from: mapTrustZones
      to: pkgBundleRefs
    - from: mapTrustZones
      to: sort.Slice
    - from: mapTrustZones
      to: sortedCopy
    - from: pkgBundleRefs
      to: append
    - from: pkgBundleRefs
      to: evidenceRef
    - from: pkgBundleRefs
      to: len
    - from: pkgBundleRefs
      to: make
    - from: pkgBundleRefs
      to: sort.Strings
    - from: readModuleName
      to: filepath.Join
    - from: readModuleName
      to: os.ReadFile
    - from: readModuleName
      to: string
    - from: readModuleName
      to: strings.HasPrefix
    - from: readModuleName
      to: strings.SplitN
    - from: readModuleName
      to: strings.TrimPrefix
    - from: readModuleName
      to: strings.TrimSpace
    - from: sortedCopy
      to: copy
    - from: sortedCopy
      to: len
    - from: sortedCopy
      to: make
    - from: sortedCopy
      to: sort.Strings
signals:
    fs_reads: true
    fs_writes: true
    db_calls: false
    net_calls: false
    concurrency: false
    yaml_io: true
    json_io: false
