version: 2
file:
    path: internal/evidence/generate.go
    sha256: 76de6ced53d36159964441b2c558bbc4ab6e6203db029b22d0b56b51654d8181
package:
    name: evidence
    imports:
        - path: crypto/sha256
        - path: encoding/hex
        - path: fmt
        - path: go/ast
        - path: go/parser
        - path: go/token
        - path: go/types
        - path: golang.org/x/tools/go/packages
        - path: gopkg.in/yaml.v3
        - path: iguana/internal/settings
        - path: io/fs
        - path: os
        - path: path/filepath
        - path: sort
        - path: strings
symbols:
    functions:
        - name: CleanEvidenceBundles
          exported: true
          params:
            - string
          returns:
            - int
            - error
        - name: CreateEvidenceBundle
          exported: true
          params:
            - string
          returns:
            - '*EvidenceBundle'
            - error
        - name: WalkAndGenerate
          exported: true
          params:
            - string
            - bool
          returns:
            - int
            - int
            - '[]error'
        - name: WriteEvidenceBundle
          exported: true
          params:
            - '*EvidenceBundle'
            - bool
          returns:
            - bool
            - error
        - name: buildBundle
          exported: false
          params:
            - string
            - string
            - '*ast.File'
            - '*types.Info'
            - '*types.Package'
          returns:
            - '*EvidenceBundle'
        - name: buildBundleForFile
          exported: false
          params:
            - string
            - string
            - '*packages.Package'
            - '*token.FileSet'
          returns:
            - '*EvidenceBundle'
            - error
        - name: bundleUpToDate
          exported: false
          params:
            - string
            - string
          returns:
            - bool
        - name: exprToString
          exported: false
          params:
            - ast.Expr
          returns:
            - string
        - name: extractBaseTypeName
          exported: false
          params:
            - ast.Expr
          returns:
            - string
        - name: extractCalls
          exported: false
          params:
            - '*ast.File'
            - '*types.Info'
            - '*types.Package'
            - types.Qualifier
          returns:
            - '[]Call'
        - name: extractFunction
          exported: false
          params:
            - '*ast.FuncDecl'
            - '*types.Info'
            - types.Qualifier
          returns:
            - Function
        - name: extractPackageMeta
          exported: false
          params:
            - '*ast.File'
          returns:
            - PackageMeta
        - name: extractSignals
          exported: false
          params:
            - PackageMeta
            - '[]Call'
            - '*ast.File'
          returns:
            - Signals
        - name: extractStructFields
          exported: false
          params:
            - '*ast.StructType'
          returns:
            - '[]FieldDecl'
        - name: extractSymbols
          exported: false
          params:
            - '*ast.File'
            - '*types.Info'
            - '*types.Package'
            - types.Qualifier
          returns:
            - Symbols
        - name: funcDeclName
          exported: false
          params:
            - '*ast.FuncDecl'
            - '*types.Info'
            - types.Qualifier
          returns:
            - string
        - name: loadPackageForDir
          exported: false
          params:
            - string
          returns:
            - '*packages.Package'
            - '*token.FileSet'
            - error
        - name: loadTypeInfoForFile
          exported: false
          params:
            - string
          returns:
            - '*ast.File'
            - '*types.Info'
            - '*types.Package'
            - error
        - name: makeQualifier
          exported: false
          params:
            - '*types.Package'
          returns:
            - types.Qualifier
        - name: resolveCallTarget
          exported: false
          params:
            - ast.Expr
            - '*types.Info'
            - '*types.Package'
            - types.Qualifier
          returns:
            - string
        - name: typeKind
          exported: false
          params:
            - ast.Expr
          returns:
            - string
        - name: validateEvidenceBundle
          exported: false
          params:
            - '*EvidenceBundle'
          returns:
            - error
        - name: writeBundleAt
          exported: false
          params:
            - '*EvidenceBundle'
            - string
            - bool
          returns:
            - bool
            - error
    types:
        - name: Call
          kind: struct
          exported: true
          fields:
            - name: From
              type: string
            - name: To
              type: string
        - name: EvidenceBundle
          kind: struct
          exported: true
          fields:
            - name: Version
              type: int
            - name: File
              type: FileMeta
            - name: Package
              type: PackageMeta
            - name: Symbols
              type: Symbols
            - name: Calls
              type: '[]Call'
            - name: Signals
              type: Signals
        - name: FieldDecl
          kind: struct
          exported: true
          fields:
            - name: Name
              type: string
            - name: TypeStr
              type: string
        - name: FileMeta
          kind: struct
          exported: true
          fields:
            - name: Path
              type: string
            - name: SHA256
              type: string
        - name: Function
          kind: struct
          exported: true
          fields:
            - name: Name
              type: string
            - name: Exported
              type: bool
            - name: Receiver
              type: string
            - name: Params
              type: '[]string'
            - name: Returns
              type: '[]string'
        - name: Import
          kind: struct
          exported: true
          fields:
            - name: Path
              type: string
            - name: Alias
              type: string
        - name: PackageMeta
          kind: struct
          exported: true
          fields:
            - name: Name
              type: string
            - name: Imports
              type: '[]Import'
        - name: Signals
          kind: struct
          exported: true
          fields:
            - name: FSReads
              type: bool
            - name: FSWrites
              type: bool
            - name: DBCalls
              type: bool
            - name: NetCalls
              type: bool
            - name: Concurrency
              type: bool
            - name: YAMLio
              type: bool
            - name: JSONio
              type: bool
        - name: Symbols
          kind: struct
          exported: true
          fields:
            - name: Functions
              type: '[]Function'
            - name: Types
              type: '[]TypeDecl'
            - name: Variables
              type: '[]VarDecl'
            - name: Constants
              type: '[]VarDecl'
            - name: Constructors
              type: '[]string'
        - name: TypeDecl
          kind: struct
          exported: true
          fields:
            - name: Name
              type: string
            - name: Kind
              type: string
            - name: Exported
              type: bool
            - name: Fields
              type: '[]FieldDecl'
        - name: VarDecl
          kind: struct
          exported: true
          fields:
            - name: Name
              type: string
            - name: Exported
              type: bool
    constructors:
        - CreateEvidenceBundle
        - buildBundle
        - buildBundleForFile
        - extractCalls
        - extractFunction
        - extractPackageMeta
        - extractSignals
        - extractStructFields
        - extractSymbols
calls:
    - from: CleanEvidenceBundles
      to: filepath.WalkDir
    - from: CleanEvidenceBundles.<anonymous>
      to: d.IsDir
    - from: CleanEvidenceBundles.<anonymous>
      to: d.Name
    - from: CleanEvidenceBundles.<anonymous>
      to: fmt.Errorf
    - from: CleanEvidenceBundles.<anonymous>
      to: os.Remove
    - from: CleanEvidenceBundles.<anonymous>
      to: strings.HasSuffix
    - from: CreateEvidenceBundle
      to: buildBundle
    - from: CreateEvidenceBundle
      to: filepath.ToSlash
    - from: CreateEvidenceBundle
      to: fmt.Errorf
    - from: CreateEvidenceBundle
      to: hex.EncodeToString
    - from: CreateEvidenceBundle
      to: loadTypeInfoForFile
    - from: CreateEvidenceBundle
      to: os.ReadFile
    - from: CreateEvidenceBundle
      to: parser.ParseFile
    - from: CreateEvidenceBundle
      to: sha256.Sum256
    - from: CreateEvidenceBundle
      to: token.NewFileSet
    - from: WalkAndGenerate
      to: append
    - from: WalkAndGenerate
      to: buildBundleForFile
    - from: WalkAndGenerate
      to: filepath.Rel
    - from: WalkAndGenerate
      to: filepath.ToSlash
    - from: WalkAndGenerate
      to: filepath.WalkDir
    - from: WalkAndGenerate
      to: fmt.Errorf
    - from: WalkAndGenerate
      to: len
    - from: WalkAndGenerate
      to: loadPackageForDir
    - from: WalkAndGenerate
      to: make
    - from: WalkAndGenerate
      to: settings.LoadSettings
    - from: WalkAndGenerate
      to: sort.Strings
    - from: WalkAndGenerate
      to: writeBundleAt
    - from: WalkAndGenerate.<anonymous>
      to: append
    - from: WalkAndGenerate.<anonymous>
      to: d.IsDir
    - from: WalkAndGenerate.<anonymous>
      to: d.Name
    - from: WalkAndGenerate.<anonymous>
      to: filepath.Dir
    - from: WalkAndGenerate.<anonymous>
      to: filepath.Ext
    - from: WalkAndGenerate.<anonymous>
      to: filepath.Rel
    - from: WalkAndGenerate.<anonymous>
      to: filepath.ToSlash
    - from: WalkAndGenerate.<anonymous>
      to: s.IsDenied
    - from: WalkAndGenerate.<anonymous>
      to: strings.HasPrefix
    - from: WalkAndGenerate.<anonymous>
      to: strings.HasSuffix
    - from: WriteEvidenceBundle
      to: bundleUpToDate
    - from: WriteEvidenceBundle
      to: filepath.FromSlash
    - from: WriteEvidenceBundle
      to: fmt.Errorf
    - from: WriteEvidenceBundle
      to: os.WriteFile
    - from: WriteEvidenceBundle
      to: yaml.Marshal
    - from: buildBundle
      to: extractCalls
    - from: buildBundle
      to: extractPackageMeta
    - from: buildBundle
      to: extractSignals
    - from: buildBundle
      to: extractSymbols
    - from: buildBundle
      to: makeQualifier
    - from: buildBundleForFile
      to: buildBundle
    - from: buildBundleForFile
      to: f.Pos
    - from: buildBundleForFile
      to: fmt.Errorf
    - from: buildBundleForFile
      to: fset.Position
    - from: buildBundleForFile
      to: hex.EncodeToString
    - from: buildBundleForFile
      to: os.ReadFile
    - from: buildBundleForFile
      to: parser.ParseFile
    - from: buildBundleForFile
      to: sha256.Sum256
    - from: buildBundleForFile
      to: token.NewFileSet
    - from: bundleUpToDate
      to: os.ReadFile
    - from: bundleUpToDate
      to: yaml.Unmarshal
    - from: exprToString
      to: exprToString
    - from: extractBaseTypeName
      to: extractBaseTypeName
    - from: extractCalls
      to: ast.Inspect
    - from: extractCalls
      to: make
    - from: extractCalls
      to: sort.Slice
    - from: extractCalls.<anonymous>
      to: addCall
    - from: extractCalls.<anonymous>
      to: append
    - from: extractCalls.<anonymous>
      to: currentFunc
    - from: extractCalls.<anonymous>
      to: funcDeclName
    - from: extractCalls.<anonymous>
      to: len
    - from: extractCalls.<anonymous>
      to: resolveCallTarget
    - from: extractFunction
      to: Type
    - from: extractFunction
      to: append
    - from: extractFunction
      to: ast.IsExported
    - from: extractFunction
      to: exprToString
    - from: extractFunction
      to: len
    - from: extractFunction
      to: obj.Type
    - from: extractFunction
      to: params.At
    - from: extractFunction
      to: params.Len
    - from: extractFunction
      to: recv.Type
    - from: extractFunction
      to: results.At
    - from: extractFunction
      to: results.Len
    - from: extractFunction
      to: sig.Params
    - from: extractFunction
      to: sig.Recv
    - from: extractFunction
      to: sig.Results
    - from: extractFunction
      to: sig.Variadic
    - from: extractFunction
      to: types.TypeString
    - from: extractPackageMeta
      to: append
    - from: extractPackageMeta
      to: sort.Slice
    - from: extractPackageMeta
      to: strings.Trim
    - from: extractSignals
      to: ast.Inspect
    - from: extractSignals
      to: len
    - from: extractSignals
      to: make
    - from: extractSignals
      to: strings.Contains
    - from: extractSignals
      to: strings.HasPrefix
    - from: extractStructFields
      to: append
    - from: extractStructFields
      to: ast.IsExported
    - from: extractStructFields
      to: exprToString
    - from: extractStructFields
      to: extractBaseTypeName
    - from: extractStructFields
      to: len
    - from: extractSymbols
      to: String
    - from: extractSymbols
      to: append
    - from: extractSymbols
      to: ast.IsExported
    - from: extractSymbols
      to: extractBaseTypeName
    - from: extractSymbols
      to: extractFunction
    - from: extractSymbols
      to: extractStructFields
    - from: extractSymbols
      to: make
    - from: extractSymbols
      to: sort.Slice
    - from: extractSymbols
      to: sort.Strings
    - from: extractSymbols
      to: typeKind
    - from: funcDeclName
      to: Type
    - from: funcDeclName
      to: exprToString
    - from: funcDeclName
      to: len
    - from: funcDeclName
      to: obj.Type
    - from: funcDeclName
      to: sig.Recv
    - from: funcDeclName
      to: types.TypeString
    - from: loadPackageForDir
      to: fmt.Errorf
    - from: loadPackageForDir
      to: len
    - from: loadPackageForDir
      to: packages.Load
    - from: loadPackageForDir
      to: token.NewFileSet
    - from: loadTypeInfoForFile
      to: f.Pos
    - from: loadTypeInfoForFile
      to: filepath.Abs
    - from: loadTypeInfoForFile
      to: filepath.Dir
    - from: loadTypeInfoForFile
      to: fmt.Errorf
    - from: loadTypeInfoForFile
      to: fset.Position
    - from: loadTypeInfoForFile
      to: len
    - from: loadTypeInfoForFile
      to: packages.Load
    - from: loadTypeInfoForFile
      to: token.NewFileSet
    - from: makeQualifier.<anonymous>
      to: p.Name
    - from: resolveCallTarget
      to: Name
    - from: resolveCallTarget
      to: obj.Name
    - from: resolveCallTarget
      to: obj.Pkg
    - from: resolveCallTarget
      to: pkgName.Imported
    - from: validateEvidenceBundle
      to: filepath.FromSlash
    - from: validateEvidenceBundle
      to: fmt.Errorf
    - from: validateEvidenceBundle
      to: hex.EncodeToString
    - from: validateEvidenceBundle
      to: os.ReadFile
    - from: validateEvidenceBundle
      to: sha256.Sum256
    - from: writeBundleAt
      to: bundleUpToDate
    - from: writeBundleAt
      to: fmt.Errorf
    - from: writeBundleAt
      to: os.WriteFile
    - from: writeBundleAt
      to: yaml.Marshal
signals:
    fs_reads: true
    fs_writes: true
    db_calls: false
    net_calls: false
    concurrency: false
    yaml_io: true
    json_io: false
